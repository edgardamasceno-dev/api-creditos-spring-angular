# Desafio T√©cnico ‚Äì Desenvolvimento de API de Consulta de Cr√©ditos

## Objetivo

Desenvolver uma API RESTful utilizando Spring Boot para consulta de cr√©ditos constitu√≠dos. A API deve fornecer informa√ß√µes como:

- N√∫mero do cr√©dito constitu√≠do
- N√∫mero da NFS-e
- Data da constitui√ß√£o
- Valor do ISSQN
- Tipo do cr√©dito
- Outros atributos

Al√©m disso, desenvolver um front-end em Angular para consumir a API e exibir os dados ao usu√°rio.

## Requisitos T√©cnicos

- Back-end: Java 8+, Spring Boot, Spring Data JPA, Hibernate
- Banco de Dados: PostgreSQL ou MariaDB
- Front-end: Angular 2+
- Containeriza√ß√£o: Docker
- Mensageria: Kafka, Azure Service Bus
- Testes Automatizados: JUnit, Mockito
- Padr√µes de Projeto: MVC, Repository, Factory, Singleton, entre outros

## Endpoints da API

### Consulta por N√∫mero da NFS-e

GET /api/creditos/{numeroNfse}

Descri√ß√£o: Retorna uma lista de cr√©ditos constitu√≠dos com base no n√∫mero da NFS-e.

Par√¢metro:

- numeroNfse (String): N√∫mero identificador da NFS-e

Resposta esperada:

```json
[
  {
    "numeroCredito": "123456",
    "numeroNfse": "7891011",
    "dataConstituicao": "2024-02-25",
    "valorIssqn": 1500.75,
    "tipoCredito": "ISSQN",
    "simplesNacional": "Sim",
    "aliquota": 5.0,
    "valorFaturado": 30000.00,
    "valorDeducao": 5000.00,
    "baseCalculo": 25000.00
  }
]
```

### Consulta por N√∫mero do Cr√©dito

GET /api/creditos/credito/{numeroCredito}

Descri√ß√£o: Retorna os detalhes de um cr√©dito espec√≠fico.

Par√¢metro:

- numeroCredito (String): N√∫mero identificador do cr√©dito

Resposta esperada:

```json
{
  "numeroCredito": "123456",
  "numeroNfse": "7891011",
  "dataConstituicao": "2024-02-25",
  "valorIssqn": 1500.75,
  "tipoCredito": "ISSQN",
  "simplesNacional": "Sim",
  "aliquota": 5.0,
  "valorFaturado": 30000.00,
  "valorDeducao": 5000.00,
  "baseCalculo": 25000.00
}
```

## Modelagem de Dados

### Entidade Credito

```java
@Entity
public class Credito {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private String numeroCredito;
    private String numeroNfse;
    private LocalDate dataConstituicao;
    private BigDecimal valorIssqn;
    private String tipoCredito;
    private boolean simplesNacional;
    private BigDecimal aliquota;
    private BigDecimal valorFaturado;
    private BigDecimal valorDeducao;
    private BigDecimal baseCalculo;
}
```

### Script de Cria√ß√£o da Tabela

```sql
CREATE TABLE credito (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY,
    numero_credito VARCHAR(50) NOT NULL,
    numero_nfse VARCHAR(50) NOT NULL,
    data_constituicao DATE NOT NULL,
    valor_issqn DECIMAL(15, 2) NOT NULL,
    tipo_credito VARCHAR(50) NOT NULL,
    simples_nacional BOOLEAN NOT NULL,
    aliquota DECIMAL(5, 2) NOT NULL,
    valor_faturado DECIMAL(15, 2) NOT NULL,
    valor_deducao DECIMAL(15, 2) NOT NULL,
    base_calculo DECIMAL(15, 2) NOT NULL
);
```

### Script de Popula√ß√£o

```sql
INSERT INTO credito (
    numero_credito, numero_nfse, data_constituicao, valor_issqn,
    tipo_credito, simples_nacional, aliquota, valor_faturado,
    valor_deducao, base_calculo
) VALUES
('123456', '7891011', '2024-02-25', 1500.75, 'ISSQN', true, 5.0, 30000.00, 5000.00, 25000.00),
('789012', '7891011', '2024-02-26', 1200.50, 'ISSQN', false, 4.5, 25000.00, 4000.00, 21000.00),
('654321', '1122334', '2024-01-15', 800.50, 'Outros', true, 3.5, 20000.00, 3000.00, 17000.00);
```

## Front-end

Desenvolver um front-end em Angular para consumir a API e apresentar os dados.

### Funcionalidades Esperadas

- Tela de consulta por n√∫mero da NFS-e ou n√∫mero do cr√©dito
- Tabela para exibir os resultados
- Responsivo para dispositivos m√≥veis

## Implanta√ß√£o e Infraestrutura

- A API e o front-end devem ser containerizados utilizando Docker
- O banco de dados PostgreSQL ou MariaDB deve ser provisionado localmente

## Crit√©rios de Avalia√ß√£o

- C√≥digo Limpo: boas pr√°ticas e organiza√ß√£o
- Qualidade do c√≥digo: uso de SOLID, DRY, KISS
- Funcionamento: endpoints corretos e retorno adequado dos dados
- Testes automatizados: cobertura unit√°ria e de integra√ß√£o
- Uso de Git: hist√≥rico de commits organizado
- Documenta√ß√£o: README com instru√ß√µes para rodar o projeto

## Entrega

O c√≥digo deve ser entregue em um reposit√≥rio p√∫blico do GitHub com instru√ß√µes de instala√ß√£o e execu√ß√£o no arquivo README.md.

## Desafios Adicionais

### Mensageria

Adicionar um publisher Kafka ou Azure Service Bus para notificar um t√≥pico/fila sempre que uma consulta for realizada.

### Testes

Cobrir a API com testes unit√°rios utilizando JUnit e Mockito.

## Padr√µes de Desenvolvimento

### GitFlow Workflow

```
main (produ√ß√£o)
‚îú‚îÄ‚îÄ develop (desenvolvimento)
‚îÇ   ‚îú‚îÄ‚îÄ feature/backend-api-rest
‚îÇ   ‚îú‚îÄ‚îÄ feature/frontend-angular
‚îÇ   ‚îú‚îÄ‚îÄ feature/mensageria-kafka
‚îÇ   ‚îî‚îÄ‚îÄ hotfix/bug-fix
‚îî‚îÄ‚îÄ release/v1.0.0
```

### Conventional Commits

Utilizar o padr√£o Conventional Commits para todas as mensagens de commit:

```
feat: adicionar endpoint de consulta por NFS-e
fix: corrigir valida√ß√£o de n√∫mero de cr√©dito
docs: atualizar README com instru√ß√µes Docker
test: adicionar testes unit√°rios para CreditoService
chore: configurar CI/CD pipeline
refactor: reestruturar arquitetura seguindo DDD
style: aplicar formata√ß√£o de c√≥digo
perf: otimizar consultas de banco de dados
```

### Template de Pull Request

```markdown
## üéØ Objetivo
Breve descri√ß√£o do que foi implementado

## üìã Tipo de Mudan√ßa
- [ ] Bug fix (corre√ß√£o que resolve um problema)
- [ ] Nova funcionalidade (adi√ß√£o de feature)
- [ ] Breaking change (mudan√ßa que pode afetar funcionalidades existentes)
- [ ] Documenta√ß√£o
- [ ] Refatora√ß√£o
- [ ] Testes

## üìã Checklist
- [ ] Testes unit√°rios implementados
- [ ] Testes de integra√ß√£o implementados
- [ ] Documenta√ß√£o atualizada
- [ ] Manual de deploy atualizado
- [ ] C√≥digo revisado e sem conflitos
- [ ] Build local executado com sucesso

## üß™ Como testar
Instru√ß√µes detalhadas para testar as mudan√ßas:
1. Passos para reproduzir
2. Cen√°rios de teste
3. Dados de teste necess√°rios

## üì∏ Screenshots (se aplic√°vel)
Adicionar capturas de tela das mudan√ßas na UI

## üîó Issues relacionadas
Fixes #123
Closes #456

## üìù Observa√ß√µes adicionais
Qualquer informa√ß√£o adicional relevante para o reviewer
```

### Configura√ß√£o do Commitizen

Para facilitar o uso do padr√£o Conventional Commits, configurar o Commitizen:

```json
{
  "path": "cz-conventional-changelog",
  "types": {
    "feat": {
      "description": "A new feature",
      "title": "Features"
    },
    "fix": {
      "description": "A bug fix",
      "title": "Bug Fixes"
    },
    "docs": {
      "description": "Documentation only changes",
      "title": "Documentation"
    },
    "style": {
      "description": "Changes that do not affect the meaning of the code",
      "title": "Styles"
    },
    "refactor": {
      "description": "A code change that neither fixes a bug nor adds a feature",
      "title": "Code Refactoring"
    },
    "perf": {
      "description": "A code change that improves performance",
      "title": "Performance Improvements"
    },
    "test": {
      "description": "Adding missing tests or correcting existing tests",
      "title": "Tests"
    },
    "chore": {
      "description": "Other changes that don't modify src or test files",
      "title": "Chores"
    }
  }
}
```

